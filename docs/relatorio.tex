\documentclass[12pt]{article}
\usepackage[T1]{fontenc}
\usepackage{algorithm2e}
\usepackage{dot2texi}

\usepackage{tikz}
\usepackage{listings}
\usepackage{float}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{wrapfig}
\usetikzlibrary{shapes,arrows}
\usepackage{bchart}

\makeatletter
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Textclass specific LaTeX commands.
\newenvironment{lyxlist}[1]
{\begin{list}{}
{\settowidth{\labelwidth}{#1}
 \setlength{\leftmargin}{\labelwidth}
 \addtolength{\leftmargin}{\labelsep}
 \renewcommand{\makelabel}[1]{##1\hfil}}}
{\end{list}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
%\usepackage{sbc-template}

\usepackage[brazil]{babel}
\usepackage[utf8]{inputenc}

\sloppy

\pagenumbering{arabic}

\title{Minimização de Valores de Arestas em um Grafo}

\author{Pedro Vanzella}

\makeatother

\usepackage{babel}
\usepackage{listings}
\lstset {
    mathescape,
    frame=none
}
\renewcommand{\lstlistingname}{Listagem}

\begin{document}

\maketitle

\section{Introdução}\label{sec:intro}

Uma recente mudança na regulamentação de impostos reativou uma antiga taxa sobre
operações financeiras. Esta taxa, chamada de CPMF, incide em $\%$ sobre toda e qualquer
transação bancária.

Um banco teve a idéia de minimizar o valor total pago deste imposto através de
atalhos em transferências realizadas internamente.

Por exemplo, digamos que haja cinco correntistas, $1$, $2$, $3$, $4$
 e $5$, e haja as seguintes transferências entre eles:
\begin{list}{}{}
  \item $1$ transfere $\$500$ para $2$.
  \item $2$ transfere $\$230$ para $3$.
  \item $3$ transfere $\$120$ para $4$.
  \item $1$ transfere $\$120$ para $4$.
  \item $2$ transfere $\$200$ para $5$.
\end{list}

% TODO: Colocar estas duas listas em subfigures e referenciá-las

É possível fazer quatro transferências, respeitando os valores iniciais e finais
de saldo das contas destes cinco correntistas, mas minimizando o valor de cada
transferência, de modo a pagar menos imposto:

\begin{list}{}{}
  \item $1$ transfere $\$70$ para $2$
  \item $1$ transfere $\$110$ para $3$
  \item $1$ transfere $\$240$ para $4$
  \item $1$ transfere $\$200$ para $5$
\end{list}

Podemos ver que, em ambos os casos, o total enviado e o total recebido não foi
alterado~-~apenas os valores parciais mudaram e, com eles, o valor pago em impostos.

Do ponto de vista dos correntistas, nada mudou~-~\textit{e.g.} o extrato do
correntista $1$ ainda mostrará duas transferências, uma de $\$500$ para o
correntista $2$ e uma de $\$120$ para o correntista $4$~-~, mas internamente as
transferências realizadas foram bastante diferentes.

\begin{figure}[htb!]
  \centering
  \begin{subfigure}[b]{0.5\textwidth}
    \begin{dot2tex}[neato,options=-tmath]
        \input{test_trivial.txt.input.dot}
    \end{dot2tex}
    \caption{Entrada}
    \label{fig:intro:entrada}
  \end{subfigure}%
  ~
  \begin{subfigure}[b]{0.5\textwidth}
    \begin{dot2tex}[neato,options=-tmath]
        \input{test_trivial.txt.reduced.dot}
    \end{dot2tex}
    \caption{Saída}
    \label{fig:intro:saída}
  \end{subfigure}
  \caption{Representação da entrada e da saída como grafos}
\end{figure}

\section{Entrada}\label{sec:entrada}

\begin{wrapfigure}{r}{0.3\textwidth}
  \vspace{-20pt}
  \begin{center}
    \begin{lstlisting}
    5 5
    1 2 500
    2 3 230
    3 4 120
    1 4 120
    2 5 200
    \end{lstlisting}
  \end{center}
  \caption{Arquivo de entrada}
  \vspace{-10pt}
\label{fig:entrada:file}
\end{wrapfigure}

O arquivo de entrada é algo no formato mostrado na Figura~\ref{fig:entrada:file}.
A primeira linha tem dois valores: a quantidade de correntistas e a quantidade
de transações descritas no arquivo. Como veremos na Sessão~\ref{sec:estrutura},
estas informações não serão necessárias.

As linhas seguintes têm três valores cada: o correntista que originou a
transação, o correntista de destino da transação, e o valor da transação. Por
exemplo, na linha 2 da Figura~\ref{fig:entrada:file}, lemos ``\textit{Uma
  transferência de 500 da conta do correntista 1 para a conta do correntista 2.}''.

\section{Estrutura de Dados}\label{sec:estrutura}

Para a representação do grafo de transferências, utilizamos dois
\textit{hashes}, um de nodos e um de arestas. Uma das vantagens disto se dá na
leitura do arquivo de entrada. Veja o algoritmo da Figura~\ref{fig:estrutura:alg:leitura}.

\begin{figure}[htb!]
  \centering
\begin{lstlisting}
Para cada linha l no arquivo, exceto a primeira:
    partes = l.separa(' ')
    nodo_a = partes[0]
    nodo_b = partes[1]
    valor = partes[2]

    self.nodes[nodo_a] = True
    self.nodes[nodo_b] = True
    self.edges[nodo_a + ',' + nodo_b] = valor
\end{lstlisting}
  \caption{Algoritmo de criação de nodos e arestas}
  \label{fig:estrutura:alg:leitura}
\end{figure}

\section{Algoritmo}\label{sec:algoritmo}

\section{Resultados}\label{sec:resultados}


\end{document}
